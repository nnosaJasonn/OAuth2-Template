<html>
	<head>
	</head>
	<body>
        <h1>Auth with Spotify</h1>
        <form method="GET" action="/login">
            <button type=submit>Authenticate</button>
        </form>
        <form method="GET" action="/topsongs">
            <input name="token" id="token" type="text">
            <button type=submit>get top songs</button>
        </form>
        <table>
            <th>
                <td>artist</td>
                <td>song</td>
            </th>
            <tbody id='res'>
                
            </tbody>
        </table>
    </body>
    <script>
        function getHashParams() {
            var hashParams = {};
            var e, r = /([^&;=]+)=?([^&;]*)/g,
                q = window.location.hash.substring(1);
            while ( e = r.exec(q)) {
               hashParams[e[1]] = decodeURIComponent(e[2]);
            }
            return hashParams;
          }
          let toke = document.getElementById('token');
       let ul = document.getElementById('res');
       var params = getHashParams();
       var access_token = params.access_token,
            refresh_token = params.refresh_token,
            error = params.error,
            result = params.result;
            console.log(result);
            console.log(error);
        toke.value = access_token;
let html = '';
if(result != null)
{
    result.forEach(res => {
        html += `<tr><td>${res.artist}</td><td>${res.song}</td></tr>`;
    })
    ul.innerHTML = html;
    
}
    </script>
    
    
</html>